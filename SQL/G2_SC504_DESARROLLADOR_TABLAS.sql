-- Producto
CREATE TABLE PRODUCTO (
    PRODUCTO_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOMBRE VARCHAR2(50 CHAR) NOT NULL,
    CATEGORIA VARCHAR2(30 CHAR) NOT NULL,
    DESCRIPCION VARCHAR2(255 CHAR) NOT NULL,
    PRECIO NUMBER(10,2) NOT NULL
);


-- Inventario
CREATE TABLE INVENTARIO (
    PRODUCTO_ID NUMBER PRIMARY KEY,
    CANTIDAD_ACTUAL NUMBER NOT NULL,
    CONSTRAINT FK_INV_PRODUCTO
        FOREIGN KEY (PRODUCTO_ID) REFERENCES PRODUCTO(PRODUCTO_ID)
);

-- Cliente
CREATE TABLE CLIENTE (
    CLIENTE_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOMBRE VARCHAR2(100 CHAR) NOT NULL,
    CORREO VARCHAR2(100 CHAR) NOT NULL,
    TELEFONO VARCHAR2(20 CHAR)  NOT NULL,
    DIRECCION VARCHAR2(255 CHAR) NOT NULL
);

-- Pedido
CREATE TABLE PEDIDO (
    PEDIDO_ID  NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    CLIENTE_ID NUMBER NOT NULL,
    FECHA DATE NOT NULL,
    ESTADO VARCHAR2(30 CHAR) NOT NULL,
    CONSTRAINT FK_PEDIDO_CLIENTE
        FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(CLIENTE_ID)
);

-- DetallePedido
CREATE TABLE DETALLEPEDIDO (
    DETALLE_PEDIDO_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    PEDIDO_ID NUMBER NOT NULL,
    PRODUCTO_ID NUMBER NOT NULL,
    CANTIDAD  NUMBER NOT NULL,
    SUBTOTAL NUMBER(10,2),
    CONSTRAINT FK_DET_PED_PEDIDO
        FOREIGN KEY (PEDIDO_ID) REFERENCES PEDIDO(PEDIDO_ID),
    CONSTRAINT FK_DET_PED_PRODUCTO
        FOREIGN KEY (PRODUCTO_ID) REFERENCES PRODUCTO(PRODUCTO_ID)
);

-- AtencionCliente
CREATE TABLE ATENCIONCLIENTE (
    ATENCION_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    CLIENTE_ID NUMBER NOT NULL,
    PEDIDO_ID NUMBER,
    TIPO VARCHAR2(50 CHAR)  NOT NULL,
    DESCRIPCION VARCHAR2(255 CHAR) NOT NULL,
    FECHA DATE NOT NULL,
    ESTADO VARCHAR2(30 CHAR) NOT NULL,
    CONSTRAINT FK_ATC_CLIENTE
        FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(CLIENTE_ID),
    CONSTRAINT FK_ATC_PEDIDO
        FOREIGN KEY (PEDIDO_ID) REFERENCES PEDIDO(PEDIDO_ID)
);

-- Reclamo
CREATE TABLE RECLAMO (
    RECLAMO_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    ATENCION_ID NUMBER  NOT NULL,
    DETALLE_PEDIDO_ID NUMBER NOT NULL,
    TIPO_RECLAMO VARCHAR2(50 CHAR) NOT NULL,
    DESCRIPCION VARCHAR2(255 CHAR) NOT NULL,
    ESTADO VARCHAR2(30 CHAR) NOT NULL,
    CONSTRAINT FK_RECLAMO_ATENCION
        FOREIGN KEY (ATENCION_ID) REFERENCES ATENCIONCLIENTE(ATENCION_ID),
    CONSTRAINT FK_RECLAMO_DETALLE
        FOREIGN KEY (DETALLE_PEDIDO_ID) REFERENCES DETALLEPEDIDO(DETALLE_PEDIDO_ID)
);

-- Devolucion
CREATE TABLE DEVOLUCION (
    DEVOLUCION_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    DETALLE_PEDIDO_ID NUMBER NOT NULL,
    RECLAMO_ID NUMBER NOT NULL,
    MOTIVO VARCHAR2(255 CHAR) NOT NULL,
    ESTADO VARCHAR2(30 CHAR) NOT NULL,
    CONSTRAINT FK_DEV_DETALLE
        FOREIGN KEY (DETALLE_PEDIDO_ID) REFERENCES DETALLEPEDIDO(DETALLE_PEDIDO_ID),
    CONSTRAINT FK_DEV_RECLAMO
        FOREIGN KEY (RECLAMO_ID) REFERENCES RECLAMO(RECLAMO_ID)
);

-- Proveedor
CREATE TABLE PROVEEDOR (
    PROVEEDOR_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOMBRE VARCHAR2(100 CHAR) NOT NULL,
    TELEFONO VARCHAR2(20 CHAR)  NOT NULL,
    CORREO VARCHAR2(100 CHAR) NOT NULL
);

-- ProductoProveedor 
CREATE TABLE PRODUCTOPROVEEDOR (
    PROVEEDOR_ID NUMBER NOT NULL,
    PRODUCTO_ID  NUMBER NOT NULL,
    CONSTRAINT PK_PROD_PROV PRIMARY KEY (PROVEEDOR_ID, PRODUCTO_ID),
    CONSTRAINT FK_PP_PROVEEDOR 
        FOREIGN KEY (PROVEEDOR_ID) REFERENCES PROVEEDOR(PROVEEDOR_ID),
    CONSTRAINT FK_PP_PRODUCTO 
        FOREIGN KEY (PRODUCTO_ID) REFERENCES PRODUCTO(PRODUCTO_ID)
);

-- OrdenCompra
CREATE TABLE ORDENCOMPRA (
    ORDEN_COMPRA_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    PROVEEDOR_ID NUMBER NOT NULL,
    FECHA DATE NOT NULL,
    ESTADO VARCHAR2(30 CHAR) NOT NULL,
    CONSTRAINT FK_OC_PROVEEDOR
        FOREIGN KEY (PROVEEDOR_ID) REFERENCES PROVEEDOR(PROVEEDOR_ID)
);

-- DetalleOrden
CREATE TABLE DETALLEORDEN (
    DETALLE_ORDEN_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    ORDEN_COMPRA_ID NUMBER NOT NULL,
    PRODUCTO_ID NUMBER NOT NULL,
    CANTIDAD NUMBER NOT NULL,
    CONSTRAINT FK_DO_OC 
        FOREIGN KEY (ORDEN_COMPRA_ID) REFERENCES ORDENCOMPRA(ORDEN_COMPRA_ID),
    CONSTRAINT FK_DO_PRODUCTO 
        FOREIGN KEY (PRODUCTO_ID) REFERENCES PRODUCTO(PRODUCTO_ID)
);

--USUARIOS INTERFAZ GR√ÅFICA
CREATE TABLE USUARIO (
    USUARIO_ID NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    NOMBRE_USUARIO VARCHAR2(60) NOT NULL,
    CONTRASENA VARCHAR2(255) NOT NULL,
    ROL VARCHAR2(30) NOT NULL,
    ESTADO VARCHAR2(20) NOT NULL
)